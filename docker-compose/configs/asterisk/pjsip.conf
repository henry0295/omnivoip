;================================ TRANSPORTS ================================
[transport-udp]
type=transport
protocol=udp
bind=0.0.0.0:5060
external_media_address=${EXTERNAL_IP}
external_signaling_address=${EXTERNAL_IP}
local_net=172.0.0.0/8
local_net=192.168.0.0/16
local_net=10.0.0.0/8

[transport-tcp]
type=transport
protocol=tcp
bind=0.0.0.0:5060

[transport-ws]
type=transport
protocol=ws
bind=0.0.0.0:8088

[transport-wss]
type=transport
protocol=wss
bind=0.0.0.0:8089
cert_file=/etc/asterisk/keys/asterisk.crt
priv_key_file=/etc/asterisk/keys/asterisk.key
ca_list_file=/etc/asterisk/keys/ca.crt

;================================ TEMPLATES ================================
[endpoint-internal](!)
type=endpoint
context=from-internal
disallow=all
allow=ulaw
allow=alaw
allow=opus
allow=vp8
allow=h264
dtmf_mode=rfc4733
rtp_symmetric=yes
force_rport=yes
rewrite_contact=yes
ice_support=yes
direct_media=no
trust_id_inbound=yes
trust_id_outbound=yes
send_pai=yes
callerid_privacy=allowed_not_screened
device_state_busy_at=1

[endpoint-webrtc](!)
type=endpoint
context=from-webrtc
transport=transport-wss
disallow=all
allow=opus
allow=ulaw
allow=vp8
allow=h264
webrtc=yes
dtls_auto_generate_cert=yes
dtls_verify=fingerprint
dtls_setup=actpass
ice_support=yes
media_encryption=dtls
rtcp_mux=yes
use_avpf=yes
force_avpf=yes
rtp_symmetric=yes
rewrite_contact=yes
direct_media=no
trust_id_inbound=yes
send_pai=yes
dtmf_mode=rfc4733

[auth-userpass](!)
type=auth
auth_type=userpass

[aor-single](!)
type=aor
max_contacts=1
remove_existing=yes
qualify_frequency=60
maximum_expiration=3600
minimum_expiration=60

[aor-multiple](!)
type=aor
max_contacts=5
remove_existing=no
qualify_frequency=60

;================================ TRUNK TEMPLATES ================================
[trunk-template](!)
type=endpoint
context=from-trunk
disallow=all
allow=ulaw
allow=alaw
dtmf_mode=rfc4733
rtp_symmetric=yes
force_rport=yes
rewrite_contact=yes
direct_media=no
trust_id_inbound=yes

;================================ AGENTS (WebRTC) ================================
; Template for agent endpoints
[agent-template](endpoint-webrtc)
context=from-agents
callerid=Agent <1000>

; Example agents - these should be created dynamically
[agent1000](agent-template)
callerid=Agent 1000 <1000>

[agent1000](auth-userpass)
password=SecurePass1000
username=agent1000

[agent1000](aor-single)
contact=

[agent1001](agent-template)
callerid=Agent 1001 <1001>

[agent1001](auth-userpass)
password=SecurePass1001
username=agent1001

[agent1001](aor-single)
contact=

[agent1002](agent-template)
callerid=Agent 1002 <1002>

[agent1002](auth-userpass)
password=SecurePass1002
username=agent1002

[agent1002](aor-single)
contact=

;================================ QUEUES ================================
; Queue endpoints for queue members
[queue-member-template](endpoint-internal)
context=from-queues

;================================ EXTERNAL TRUNKS ================================
; Example SIP trunk configuration
[trunk-provider](trunk-template)
aors=trunk-provider
outbound_auth=trunk-provider-auth

[trunk-provider](aor-single)
contact=sip:provider.example.com:5060

[trunk-provider-auth](auth-userpass)
username=your-trunk-username
password=your-trunk-password

;================================ KAMAILIO INTEGRATION ================================
; Endpoint for Kamailio proxy
[kamailio](endpoint-internal)
type=endpoint
context=from-kamailio
transport=transport-udp
aors=kamailio
disallow=all
allow=ulaw
allow=alaw
allow=opus
direct_media=no
trust_id_inbound=yes
from_domain=omnivoip.local

[kamailio](aor-multiple)
type=aor
contact=sip:kamailio:5060
qualify_frequency=30

;================================ SYSTEM ================================
[default-external](endpoint-internal)
type=endpoint
context=from-external
transport=transport-udp

;================================ REGISTRATION ================================
; Outbound registration if needed
;[trunk-registration]
;type=registration
;transport=transport-udp
;outbound_auth=trunk-provider-auth
;server_uri=sip:provider.example.com
;client_uri=sip:your-number@provider.example.com
;retry_interval=60
